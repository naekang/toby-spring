#2장 - 테스트
---

- 계속 변화하고 복잡해지는 애플리케이션에 대응하기 위한 2가지 전략
  - 객체지향 설계 및 이것을 효과적으로 담아낼 수 있는 IoC/DI 기술
  - 코드를 확신할 수 있게 해주고, 변화에 유연하게 대철할 수 있는 자신감을 주는 테스트 기술
    - 테스트는 스프링을 학습하는데 있어 가장 효과적인 방법
  
## 2.1 UserDaoTest 다시보기

##### 테스트의 유용성
- 웹을 통한 DAO 테스트 방법의 문제점
  - 일반적인 웹 어플리케이션 테스트 방식
    - DAO, Service, MVC 프레젠테이션 계층까지 다 만듦
    - 서버에 배치
    - 웹 화면을 띄워 폼을 열고, 값을 입력한 뒤 버튼을 눌러 등록해봄
    - 에러가 없는지 확인
  - 모든것을 만들고 나서야 테스트가 가능하다는 것이 가장 큰 문제
  - 다 만들고 나서 한번에 테스트하기 떄문에 어디서 문제가 발생했는지 알 수 없음
  
- 작은 단위의 테스트
  - 필요성
    - 개발자는 사람이기 때문에 실수가 나올수도 있고 반복적인 행동에 지침
    
- 지속적인 개선과 점진적인 개발을 위한 테스트
  - 이미 검증 가능한 테스트가 있기에 조금씩 코드 개선
  - 변경된 코드는 단위 테스트를 통해 간단한 확인 가능
  
##### UserDaoTest의 문제점
- 수동 확인 작업의 번거로움
  - 검증 양이 많아지면 사람이 눈으로 일일히 확인이 불가능함
  
- 실행 작업의 번거로움
  - 체계적으로 간편하게 실행되는 것이 중요

## 2.2 UserDaoTest 개선

##### 테스트 검증의 자동화
- 테스트란 개발자가 마음 편하게 잠자리에 들 수 있도록!
- 만들어진 코드의 기능을 모두 점검할 수 있는 포괄적인 테스트 필요
- 에러 발생은 JVM에서 호출스택과 에러메시지가 상세히 출력됨

##### 테스트의 효율적인 수행과 결과 관리
- `JUnit`테스트
  - 프로그래머를 위한 자바 테스팅 프레임워크
  - 기존 main() -> 테스트 메소드
    - `@Test` 어노테이션 추가
    - public 선언
  - 검증 코드 전환
    - `AssertThat` 스태택 메소드 활용(JUnit 버전별 문법 확인)
  - 실행
    - 인텔리제이에서 바로 실행 가능
  - 결과
    - 실패시 바로 이동 가능

## 2.3 개발자를 위한 테스팅 프레임워크 JUnit
- 스프링 프레임워크 자체도 JUnit 프레임워크를 이용해 테스트를 만들어가며 개발함

##### JUnit 테스트 실행 방법
- IDE - IntelliJ

##### 테스트 결과의 일관성
- UserDaoTest의 불편한점
  - 매번 테스트 실행할 떄마다 USER 테이블을 모두 삭제해줘야 함
- 테스트가 외부 상태에 따라 결과 달라짐 -> 별도의 작업이 필요해 번거로움
- 코드 변경사항이 없다면 테스트는 늘 동일한 결과값을 가져야 함 = 테스트 결과의 일관성

- `deleteAll`메소드
  - USER 테이블 모든 레코드 삭제
  
- `getCount()`메소드
  - USER 테이블 레코드 개수 반환
  
- 테스트
  - addAndGet 시작시 deleteAll() -> getCount 0인지 확인
  - UserDao.add() 후 getCount 1인지 확인
  
##### 포괄적인 테스트
- 